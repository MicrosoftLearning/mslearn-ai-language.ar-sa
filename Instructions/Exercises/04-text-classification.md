---
lab:
  title: تصنيف نص مخصص
  module: Module 3 - Getting Started with Natural Language Processing
---

# تصنيف نص مخصص

توفر خدمة Azure AI Language العديد من قدرات NLP، بما في ذلك تعريف العبارة الرئيسية، وتلخيص النص، وتحليل التوجه. توفر خدمة Language أيضا ميزات مخصصة مثل الإجابة على الأسئلة المخصصة وتصنيف النص المخصص.

لاختبار تصنيف النص المخصص لخدمة Azure AI Language، سنقوم بتكوين النموذج باستخدام Language Studio ثم استخدام تطبيق سطر أوامر صغير يعمل في Cloud Shell لاختباره. يمكن اتباع نفس النمط والوظائف المستخدمة هنا لتطبيقات العالم الحقيقي.

## توفير مورد *Azure AI Language*

إذا لم يكن لديك بالفعل واحد في اشتراكك، فسيتعين عليك توفير مورد **خدمة Azure AI Language**. بالإضافة إلى ذلك، لاستخدام تصنيف النص المخصص، ينبغي لك تمكين ميزة **تصنيف النص المخصص واستخراجه**.

1. في متصفح، افتح مدخل Microsoft Azure في ⁧`https://portal.azure.com`⁩، وسجّل الدخول باستخدام حسابك في Microsoft.
1. حدد حقل البحث في أعلى المدخل، وابحث عن `Azure AI services`، وأنشئ **مورد Language Service** .
1. حدد المربع الذي يتضمن **تصنيف النص المخصص**. ثم حدد **متابعة لإنشاء المورد الخاص بك**.
1. إنشاء المورد بالإعدادات التالية:
    - **الاشتراك**: *اشتراك Azure الخاص بك*.
    - **مجموعة الموارد**: *تحديد مجموعة موارد أو إنشاؤها*.
    - **المنطقة**: *اختر من إحدى المناطق التالية*\*
        - شرق أستراليا
        - وسط الهند‬
        - شرق الولايات المتحدة
        - East US 2
        - أوروبا الشمالية
        - South Central US
        - شمال سويسرا
        - جنوب المملكة المتحدة
        - أوروبا الغربية
        - West US 2
        - غرب الولايات المتحدة الأمريكية 3
    - **الاسم**: *أدخل اسمًا مميزًا*.
    - **مستوى الأسعار**: حدد **F0** (*مجاني*) أو **S** (*قياسي*) إذا لم يكن F متوفراً.
    - **حساب التخزين**: حساب تخزين جديد
      - **اسم حساب التخزين**: *أدخل اسمًا فريدًا*.
      - **نوع حساب التخزين**: LRS قياسي
    - **Responsible AI notice**: محدد.

1. حدد **مراجعة + إنشاء**، ثم حدد **إنشاء** لتوفير المورد.
1. انتظر حتى يكتمل النشر، ثم انتقل إلى المورد المنشور.
1. اعرض صفحة **المفاتيح ونقطة النهاية**. ستحتاج إلى المعلومات الموجودة في هذه الصفحة لاحقاً في التدريب.

## تحميل مقالات العينة

بمجرد إنشاء خدمة اللغة وحساب التخزين، ستحتاج إلى تحميل مقالات نموذجية لتدريب نموذجك لاحقا.

1. في علامة تبويب متصفح جديدة، نزّل مقالات عادية من `https://aka.ms/classification-articles` واستخراج الملفات إلى مجلد من اختيارك.

1. في مدخل Microsoft Azure، انتقل إلى حساب التخزين الذي أنشأته، وحدده.

1. في حساب التخزين خاصتك، حدد **تكوين**، الموجود أسفل **إعدادات**. في شاشة التكوين، قم بتمكين الخيار** السماح بالوصول المجهول إلى كائن ثنائي الحجم** ثم حدد **حفظ**.

1. حدّد **الحاويات** من القائمة اليمنى الموجودة أسفل **تخزين البيانات**. على الشاشة التي تظهر، حدد **+ Container**. امنح الحاوية الاسم `articles`، وحدّد **مستوى الوصول المجهول** إلى **الحاوية (الوصول المجهول للقراءة فقط للحاويات والكائنات الثنائية كبيرة الحجم)**.

    > **ملاحظة**: عند تكوين حساب تخزين لحلّ حقيقي، احرص على تعيين مستوى الوصول المناسب. لمعرفة المزيد حول كل مستوى وصول، راجِع [مستندات Azure Storage](https://learn.microsoft.com/azure/storage/blobs/anonymous-read-access-configure).

1. بعد إنشاء الحاوية، حددها ثم حدد زر **تحميل** . حدد **استعراض بحثا عن الملفات** لاستعراض المقالات العادية التي نزلتها. ثم حدد **تحميل**.

## إنشاء مشروع تصنيف نص مخصص

بعد اكتمال التكوين، قم بإنشاء مشروع تصنيف نص مخصص. يوفر هذا المشروع مكانا للعمل لبناء نموذجك وتدريبه وتوزيعه.

> **ملاحظة**: يستخدم هذا التمرين المعملي **Language Studio**، ولكن يمكنك أيضا إنشاء نموذجك وبنائه وتدريبه وتوزيعه من خلالREST API.

1. في علامة تبويب جديدة بالمتصفح، افتح مدخل « Azure AI Language Studio» في `https://language.cognitive.azure.com/`، ثم سجّل الدخول باستخدام حساب Microsoft المقترن باشتراك Azure خاصتك.
1. إذا طلب منك اختيار مورد Language، حدد الإعدادات التالية:

    - **Azure Directory**: دليل Azure الذي يحتوي على اشتراكك.
    - **Azure subscription**: اشتراك Azure الخاص بك.
    - **نوع المورد**: اللغة.
    - **مورد اللغة**: مورد Azure AI Language الذي أنشأتَه سابقًا.

    إذا <u>لم</u> تتم مطالبتك باختيار مورد language، فقد يرجع ذلك إلى وجود موارد Language متعددة في اشتراكك؛ وفي هذه الحالة:

    1. في الشريط الموجود أعلى الصفحة، حدّد زر **الإعدادات (&#9881؛**.
    2. في الصفحة **Settings** اعرض علامة التبويب **Resources**.
    3. حدد مورد language الذي أنشأته للتو، وانقر فوق **Switch resource**.
    4. في أعلى الصفحة، انقر فوق **Language Studio** للعودة إلى الصفحة الرئيسية في Language Studio

1. في أعلى المدخل، في القائمة **إنشاء جديد**، حدد **تصنيف النصوص المخصصة**.
1. تظهر صفحة **توصيل تخزين**. ستكون كافة القيم قد ملئت بالفعل. لذا حدد **التالي**.
1. في صفحة **تحديد نوع المشروع**، حدد **تصنيف ملصق مفرد**. بعد ذلك حدد **التالي**.
1. في جزء**إدخال المعلومات الأساسية**، ثم عيّن ما يلي:
    - **الاسم:** `ClassifyLab`  
    - **Text primary language**: English (US)
    - **الوصف**: `Custom text lab`

1. حدد **التالي**.
1. في صفحة **اختيار حاوية**، قم بتعيين القائمة المنسدلة**لحاوية متجر كائن ثنائي الحجم** على حاوية *مقالاتك*.
1. حدد الخيار ** لا، أحتاج إلى تسمية ملفاتي كجزء من هذا المشروع**. بعد ذلك حدد **التالي**.
1. حدد **إنشاء مشروع**

> **تلميح**: إذا ظهر لديك خطأ بشأن عدم تفويضك لتنفيذ هذه العملية، فستحتاج إلى إضافة تعيين دور. لتصحيح ذلك، نقوم بإضافة دور "المساهم ببيانات الكائن الثنائي كبير الحجم للتخزين" على حساب التخزين للمستخدم والذي يقوم بتشغيل النشاط العملي. يمكن العثور على مزيدٍ من التفاصيل في [صفحة الوثائق](https://learn.microsoft.com/azure/ai-services/language-service/custom-named-entity-recognition/how-to/create-project?tabs=portal%2Clanguage-studio#enable-identity-management-for-your-resource).

## تسمية البيانات

الآن بعد أن تم إنشاء مشروعك، تحتاج إلى تسمية بياناتك أو وضع علامة عليها لتدريب نموذجك على كيفية تصنيف النص.

1. على اليسار، حدد **تسمية البيانات**، إذا لم تكن محددة بالفعل. سترى قائمة بالملفات التي قمت بتحميلها إلى حساب التخزين الخاص بك.
1. على الجانب الأيسر، في جزء**النشاط**، حدد **+ إضافة فئة**.  تندرج المقالات في هذا المعمل في أربع فئات ستحتاج إلى إنشائها: `Classifieds`و `Sports` و`News`و `Entertainment`.

    ![لقطة شاشة تعرض صفحة «tag data» وزر «add class».](../media/tag-data-add-class-new.png#lightbox)

1. بعد إنشاء الفئات الأربع، حدد **مقالة 1** للبدء. هنا يمكنك قراءة المقالة، وتحديد الفئة التي يمثلها هذا الملف، ومجموعة البيانات (التدريب أو الاختبار) التي تريد تخصيصها.
1. قم بتعيين كل مقالة للفئة المناسبة ومجموعة البيانات (التدريب أو الاختبار) باستخدام جزء **النشاط** على اليمين.  يمكنك تحديد تسمية من قائمة التسميات على اليمين، وتعيين كل مقالة **للتدريب** أو **الاختبار** باستخدام الخيارات الموجودة أسفل جزء النشاط. يمكنك تحديد **المستند التالي**للانتقال إلى المستند التالي. لأغراض هذا المختبر، سنحدد ما الذي سيتم استخدامه لتدريب النموذج واختباره:

    | مقالة  | الفصل  | مجموعة البيانات  |
    |---------|---------|---------|
    | Article 1 | رياضات | التدريب |
    | Article 10 | الأخبار | التدريب |
    | Article 11 | الترفيه | الاختبار |
    | Article 12 | الأخبار | الاختبار |
    | Article 13 | رياضات | الاختبار |
    | Article 2 | رياضات | التدريب |
    | Article 3 | Classifieds | التدريب |
    | Article 4 | Classifieds | التدريب |
    | Article 5 | الترفيه | التدريب |
    | Article 6 | الترفيه | التدريب |
    | Article 7 | الأخبار | التدريب |
    | Article 8 | الأخبار | التدريب |
    | Article 9 | الترفيه | التدريب |

    > **ملاحظة**يتم سرد الملفات في Language Studio أبجديا، وهذا هو السبب في أن القائمة أعلاه ليست بترتيب تسلسلي. تأكد من زيارة صفحتي المستندات عند تسمية مقالاتك.

1. حدد **حفظ أوصاف** لحفظها.

## تدريب النموذج

بمجرد تسمية بياناتك، تحتاج إلى تدريب نموذجك.

1. حدد **وظائف تدريب** من القائمة الجانبية اليسرى.
1. حدد ** بدء وظيفة تدريب**.
1. تدريب نموذج جديد باسم `ClassifyArticles`.
1. حدد **استخدام تقسيم يدوي لبيانات التدريب والاختبار**.

    > **نصيحة** في مشاريع التصنيف الخاصة بك، ستقوم خدمة Azure AI Language تلقائيا بتقسيم الاختبار الذي تم تعيينه حسب النسبة المئوية وهو أمر مفيد مع مجموعة بيانات كبيرة. مع مجموعات البيانات الأصغر، من المهم التدريب مع توزيع الفئة المناسبة.

1. حدد **Train**

> **مهم** قد يستغرق تدريب نموذجك عدة دقائق في بعض الأحيان. ستتلقى إعلاما عند اكتماله.

## تقييم نموذجك

في تطبيقات العالم الحقيقي لتصنيف النص، من المهم تقييم نموذجك وتحسينه للتحقق من أدائه كما تتوقع.

1. حدد **Model performance**، وحدد نموذج **ClassifyArticles** خاصتك. ثم يمكنك أن ترى تسجيل النموذج الخاص بك، ومقاييس الأداء، ومتى تم تدريبه. إذا لم يكن تسجيل نموذجك 100%، فهذا يعني أن أحد المستندات المستخدمة للاختبار لم يتم تقييمه إلى ما تم تسميته. يمكن أن تساعدك هذه الإخفاقات على فهم مكان التحسين.
1. حدد علامة تبويب** تفاصيل مجموعة الاختبار**. إذا كانت هناك أي أخطاء، تُمكِّنك علامة التبويب هذه من الاطّلاع على المقالات التي حددتها للاختبار وما يتوقعه النموذج وما إذا كان ذلك يتعارض مع تسمية الاختبار الخاصة بها. تعين علامة التبويب افتراضيًا لإظهار تنبؤات غير صحيحة فقط. يمكنك تبديل **الخيار إظهار عدم التطابق فقط** لمشاهدة جميع المقالات التي أشرت إليها للاختبار وما توقعه كل منها.

## استخدام نموذجك

بمجرد أن تكون راضيًا عن تدريب النموذج الخاص بك، فقد حان الوقت لتوزيعه والذي يسمح لك بالبدء في تصنيف النص من خلال API.

1. في الجزء إلى اليسار، حدد **نشر نموذج**.
1. حدد **إضافة نشر**، ثم أدخل `articles` في **حقل قم بإنشاء اسم نشر جديد**، وحدد **تصنيف مقالات** في حقل **نموذج**.
1. حدد **نشر** لنشر نموذجك.
1. بمجرد نشر نموذجك اترك هذه الصفحة مفتوحة. ستكون بحاجة إلى اسم المشروع والنشر في الخطوة التالية.

## الاستعداد لتطوير تطبيق في تعليمة Visual Studio البرمجية

لاختبار قدرات تصنيف النص المخصصة لخدمةAzure AI Language، ستقوم بتطوير تطبيق وحدة تحكم بسيط في Visual Studio Code.

> **تلميح**: إذا استنسخت بالفعل مستودع **mslearn-ai-language**، فافتحه في تعليمة Visual Studio. وإلا فاتبع هذه الخطوات لاستنساخه إلى بيئة التطوير الخاصة بك.

1. ابدأ تشغيل Visual Studio Code.
2. افتح لوحة (SHIFT+CTRL+P) وشغّل **Git: استنسخ الأمر ** لاستنساخ مستودع `https://github.com/MicrosoftLearning/mslearn-ai-language` إلى مجلد محلي (لا يُهم أي مجلد).
3. عند استنساخ المستودع، افتح المجلد في Visual Studio Code.

    > **ملاحظة**: إذا عرضت لك Visual Studio Code رسالة منبثقة لمطالبتك بالثقة في التعليمات البرمجية التي تفتحها، فانقر فوق **نعم، أثق في خيار الكُتاب** في النافذة المنبثقة.

4. انتظر حتى تثبيت ملفات إضافية لدعم مشاريع التعليمات البرمجية C# في المستودع.

    > **ملاحظة**: في حالة مطالبتك بإضافة الأصول المطلوبة للبناء وتصحيح الأخطاء، فحدد **ليس الآن**.

## تكوين تطبيقك

تم توفير تطبيقات لكل من C# وPython، وكذلك ملف نصي نموذجي ستستخدمه لاختبار التلخيص. يتميز كلا التطبيقين بالوظيفة نفسها. أولاً، ستكمل بعض الأجزاء الرئيسية من التطبيق لتمكينه من استخدام مورد Azure AI Language الخاص بك.

1. في Visual Studio Code، في جزء **مستكشف** ، استعرض للوصول إلى **مجلد Labfiles/04-text-classification** وقم بتوسيع المجلد** CSharp** أو **Python** استنادا إلى تفضيلات اللغة ومجلد **تصنيف نص** الذي يحتوي عليه. يحتوي كل مجلد على الملفات الخاصة باللغة للتطبيق الذي ستقوم بدمج وظيفة تصنيف نص Azure AI Language فيه.
1. انقر بزر الماوس الأيمن فوق مجلد **تصنيف نص** الذي يحتوي على ملفات التعليمات البرمجية الخاصة بك وافتح وحدة طرفية متكاملة. ثم ثبّت حزمة Azure AI Language Text Analytics SDK عن طريق تشغيل الأمر المناسب لتفضيل اللغة لديك:

    **C#:**

    ```
    dotnet add package Azure.AI.TextAnalytics --version 5.3.0
    ```

    **Python**:

    ```
    pip install azure-ai-textanalytics==5.3.0
    ```

1. في جزء**مستكشف**، في مجلد**تصنيف نص**، افتح ملف التكوين للغة المفضلة لديك

    - **C#**: appsettings.json
    - **Python**: .env
    
1. قم بتحديث قيم التكوين لتضمين **نقطة النهاية** و**مفتاح** من مورد Azure Language الذي أنشأته (متوفر في صفحة **المفاتيح ونقطة النهاية** لمورد Azure AI Language في مدخل Microsoft Azure). يجب أن يحتوي الملف بالفعل على أسماء المشروع والنشر لنموذج تصنيف لنصك.
1. احفظ ملف التكوين.

## إضافة تعليمة برمجية لتصنيف المستندات

أصبحت الآن جاهزًا لاستخدام خدمة Azure AI Language لتصنيف المستندات.

1. قم بتوسيع مجلد ** المقالات** في مجلد**تصنيف نص** لعرض المقالات النصية التي سيصنفها التطبيق الخاص بك.
1. في مجلد **تصنيف نص**، افتح ملف التعليمات البرمجية لتطبيق العميل:

    - **C#**: Program.cs
    - **Python**: classify-text.py

1. ابحث عن التعليق **استيراد مساحات الأسماء**. ومن ثم ضمن هذا التعليق، أضف التعليمات البرمجية التالية الخاصة باللغة لاستيراد مساحات الأسماء التي ستحتاج إليها لاستخدام Text Analytics SDK:

    **C#**: Programs.cs

    ```csharp
    // import namespaces
    using Azure;
    using Azure.AI.TextAnalytics;
    ```

    **Python**: classify-text.py

    ```python
    # import namespaces
    from azure.core.credentials import AzureKeyCredential
    from azure.ai.textanalytics import TextAnalyticsClient
    ```

1. في دالة **أساسي**، لاحظ أنه تم بالفعل توفير التعليمات البرمجية لتحميل نقطة نهاية خدمة Azure AI Language والمفتاح وأسماء المشروع والتوزيع من ملف التكوين. ثم ابحث عن التعليق **إنشاء عميل باستخدام نقطة النهاية والمفتاح**، وأضف التعليمة البرمجية التالية لإنشاء عميل لواجهة برمجة تطبيقات تحليل النص:

    **C#**: Programs.cs

    ```csharp
    // Create client using endpoint and key
    AzureKeyCredential credentials = new AzureKeyCredential(aiSvcKey);
    Uri endpoint = new Uri(aiSvcEndpoint);
    TextAnalyticsClient aiClient = new TextAnalyticsClient(endpoint, credentials);
    ```

    **Python**: classify-text.py

    ```Python
    # Create client using endpoint and key
    credential = AzureKeyCredential(ai_key)
    ai_client = TextAnalyticsClient(endpoint=ai_endpoint, credential=credential)
    ```

1. في الدالة **أساسي**، لاحظ أن التعليمات البرمجية الموجودة تقرأ جميع الملفات في مجلد ** المقالات** وتنشئ قائمة تحتوي على محتوياتها. ثم ابحث عن التعليق **الحصول على تصنيفات** وأضف التعليمات البرمجية التالية:

    **C#**: Program.cs

    ```csharp
    // Get Classifications
    ClassifyDocumentOperation operation = await aiClient.SingleLabelClassifyAsync(WaitUntil.Completed, batchedDocuments, projectName, deploymentName);

    int fileNo = 0;
    await foreach (ClassifyDocumentResultCollection documentsInPage in operation.Value)
    {
        
        foreach (ClassifyDocumentResult documentResult in documentsInPage)
        {
            Console.WriteLine(files[fileNo].Name);
            if (documentResult.HasError)
            {
                Console.WriteLine($"  Error!");
                Console.WriteLine($"  Document error code: {documentResult.Error.ErrorCode}");
                Console.WriteLine($"  Message: {documentResult.Error.Message}");
                continue;
            }

            Console.WriteLine($"  Predicted the following class:");
            Console.WriteLine();

            foreach (ClassificationCategory classification in documentResult.ClassificationCategories)
            {
                Console.WriteLine($"  Category: {classification.Category}");
                Console.WriteLine($"  Confidence score: {classification.ConfidenceScore}");
                Console.WriteLine();
            }
            fileNo++;
        }
    }
    ```
    
    **Python**: classify-text.py

    ```Python
    # Get Classifications
    operation = ai_client.begin_single_label_classify(
        batchedDocuments,
        project_name=project_name,
        deployment_name=deployment_name
    )

    document_results = operation.result()

    for doc, classification_result in zip(files, document_results):
        if classification_result.kind == "CustomDocumentClassification":
            classification = classification_result.classifications[0]
            print("{} was classified as '{}' with confidence score {}.".format(
                doc, classification.category, classification.confidence_score)
            )
        elif classification_result.is_error is True:
            print("{} has an error with code '{}' and message '{}'".format(
                doc, classification_result.error.code, classification_result.error.message)
            )
    ```

1. احفظ التغييرات في ملف التعليمات البرمجية خاصتك.

## اختبار التطبيق الخاص بك

أصبح الآن تطبيقك جاهزًا للاختبار.

1. في الوحدة الطرفية المتكاملة لمجلد **تصنيف نص**، وأدخل الأمر التالي لتشغيل البرنامج:

    - **C#:** `dotnet run`
    - **Python**: `python classify-text.py`

    > **تلميح**: يمكنك استخدام أيقونة **تكبير حجم اللوحة** (**^**) في شريط أدوات المحطة الطرفية لرؤية المزيد من نص وحدة التحكم.

1. مراقبة المخرجات. يجب أن يسرد التطبيق تصنيفا ودرجة ثقة لكل ملف نصي.


## تنظيف

عندما لا تحتاج إلى مشروعك بعد الآن، يمكنك حذفه من صفحة **Projects**الخاصة بك في Language Studio. يمكنك أيضا إزالة خدمة Azure AI Language وحساب التخزين المقترن في [مدخل Microsoft Azure](https://portal.azure.com).
