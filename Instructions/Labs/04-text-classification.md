---
lab:
  title: تصنيف نص مخصص
  description: طبِّق تصنيفات مخصصة على إدخال النص باستخدام Azure AI Language.
---

# تصنيف نص مخصص

توفر خدمة Azure AI Language العديد من قدرات NLP، بما في ذلك تعريف العبارة الرئيسية، وتلخيص النص، وتحليل التوجه. توفر خدمة Language أيضا ميزات مخصصة مثل الإجابة على الأسئلة المخصصة وتصنيف النص المخصص.

لاختبار تصنيف النص المخصص لخدمة Azure AI Language، ستقوم بتكوين النموذج باستخدام Language Studio ثم استخدام تطبيق Python لاختباره.

يستند هذا التمرين إلى لغة Python، لكن يمكنك تطوير تطبيقات تصنيف النصوص باستخدام عِدد تطوير برامج (SDK) خاصة بلغات متعددة، منها:

- [مكتبة عميل Azure AI Text Analytics للغة Python](https://pypi.org/project/azure-ai-textanalytics/)
- [مكتبة عميل Azure AI Text Analytics للغة NET.](https://www.nuget.org/packages/Azure.AI.TextAnalytics)
- [مكتبة عميل Azure AI Text Analytics للغة JavaScript](https://www.npmjs.com/package/@azure/ai-text-analytics)

سيستغرق هذا التمرين حوالي **35** دقيقة.

## توفير مورد *Azure AI Language*

إذا لم يكن لديك بالفعل واحد في اشتراكك، فسيتعين عليك توفير مورد **خدمة Azure AI Language**. بالإضافة إلى ذلك، لاستخدام تصنيف النص المخصص، ينبغي لك تمكين ميزة **تصنيف النص المخصص واستخراجه**.

1. افتح مدخل Azure على `https://portal.azure.com`، وسجل الدخول باستخدام حساب Microsoft المقترن باشتراك Azure.
1. حدد **Create a resource.**
1. في حقل البحث، ابحث عن **خدمة اللغة**. ثم، في النتائج، حدد **إنشاء** ضمن **خدمة اللغة**.
1. حدد المربع الذي يتضمن **تصنيف النص المخصص**. ثم حدد **متابعة لإنشاء المورد الخاص بك**.
1. إنشاء المورد بالإعدادات التالية:
    - **الاشتراك**: *اشتراك Azure الخاص بك*.
    - **مجموعة الموارد**: *تحديد مجموعة موارد أو إنشاؤها*.
    - **المنطقة**: *اختر من إحدى المناطق التالية*\*
        - شرق أستراليا
        - وسط الهند‬
        - شرق الولايات المتحدة
        - East US 2
        - أوروبا الشمالية
        - South Central US
        - شمال سويسرا
        - جنوب المملكة المتحدة
        - أوروبا الغربية
        - West US 2
        - غرب الولايات المتحدة الأمريكية 3
    - **الاسم**: *أدخل اسمًا مميزًا*.
    - **مستوى الأسعار**: حدد **F0** (*مجاني*) أو **S** (*قياسي*) إذا لم يكن F متوفراً.
    - **حساب التخزين**: حساب تخزين جديد
      - **اسم حساب التخزين**: *أدخل اسمًا فريدًا*.
      - **نوع حساب التخزين**: LRS قياسي
    - **Responsible AI notice**: محدد.

1. حدد **مراجعة + إنشاء**، ثم حدد **إنشاء** لتوفير المورد.
1. انتظر حتى يكتمل التوزيع، ثم انتقل إلى مجموعة الموارد.
1. ابحث عن حساب التخزين الذي أنشأته، وحدده، وتحقق من أن _نوع الحساب_ هو** StorageV2 **. إذا كان الإصدار 1، فيُرجى ترقية نوع حساب التخزين الخاص بك في صفحة المورد تلك.

## قُم بتكوين الوصول بناءً على الأدوار للمستخدم الخاص بك

> **ملاحظة**: إذا تخطيت هذه الخطوة، فسيظهر لك خطأ 403 عند محاولة الاتصال بمشروعك المخصص. من الضروري أن يتم تعيين هذا الدور للمستخدم الحالي للوصول إلى البيانات الثنائية الكبيرة في حساب التخزين، حتى وإن كنت مالك حساب التخزين.

1. انتقل إلى صفحة حساب التخزين في مدخل Azure.
2. حدد **التحكم في الوصول (IAM)** من قائمة التنقل اليسرى.
3. حدد **إضافة** لإضافة واجبات الدور واختَر الدور **مالك بيانات الكائن الثنائي كبير الحجم (Blob) للتخزين** في حساب التخزين.
4. ضمن **تعيين الوصول إلى**، حدد **المستخدم أو المجموعة أو كيان الخدمة**.
5. حدد **تحديد أعضاء**.
6. حدد مُستخدمك. يمكنك البحث عن أسماء المستخدمين في الحقل **Select**.

## تحميل مقالات العينة

بمجرد إنشاء خدمة اللغة وحساب التخزين، ستحتاج إلى تحميل مقالات نموذجية لتدريب نموذجك لاحقا.

1. في علامة تبويب متصفح جديدة، نزّل مقالات عادية من `https://aka.ms/classification-articles` واستخراج الملفات إلى مجلد من اختيارك.

1. في مدخل Microsoft Azure، انتقل إلى حساب التخزين الذي أنشأته، وحدده.

1. في حساب التخزين خاصتك، حدد **تكوين**، الموجود أسفل **إعدادات**. في شاشة التكوين، قم بتمكين الخيار** السماح بالوصول المجهول إلى كائن ثنائي الحجم** ثم حدد **حفظ**.

1. حدّد **الحاويات** من القائمة اليمنى الموجودة أسفل **تخزين البيانات**. على الشاشة التي تظهر، حدد **+ Container**. امنح الحاوية الاسم `articles`، وحدّد **مستوى الوصول المجهول** إلى **الحاوية (الوصول المجهول للقراءة فقط للحاويات والكائنات الثنائية كبيرة الحجم)**.

    > **ملاحظة**: عند تكوين حساب تخزين لحلّ حقيقي، احرص على تعيين مستوى الوصول المناسب. لمعرفة المزيد حول كل مستوى وصول، راجِع [مستندات Azure Storage](https://learn.microsoft.com/azure/storage/blobs/anonymous-read-access-configure).

1. بعد إنشاء الحاوية، حددها ثم حدد زر **تحميل** . حدد **استعراض بحثا عن الملفات** لاستعراض المقالات العادية التي نزلتها. ثم حدد **تحميل**.

## إنشاء مشروع تصنيف نص مخصص

بعد اكتمال التكوين، قم بإنشاء مشروع تصنيف نص مخصص. يوفر هذا المشروع مكانا للعمل لبناء نموذجك وتدريبه وتوزيعه.

> **ملاحظة**: يستخدم هذا التمرين المعملي **Language Studio**، ولكن يمكنك أيضا إنشاء نموذجك وبنائه وتدريبه وتوزيعه من خلالREST API.

1. في علامة تبويب جديدة بالمتصفح، افتح مدخل « Azure AI Language Studio» في `https://language.cognitive.azure.com/`، ثم سجّل الدخول باستخدام حساب Microsoft المقترن باشتراك Azure خاصتك.
1. إذا طلب منك اختيار مورد Language، حدد الإعدادات التالية:

    - **Azure Directory**: دليل Azure الذي يحتوي على اشتراكك.
    - **Azure subscription**: اشتراك Azure الخاص بك.
    - **نوع المورد**: اللغة.
    - **مورد اللغة**: مورد Azure AI Language الذي أنشأتَه سابقًا.

    إذا <u>لم</u> تتم مطالبتك باختيار مورد language، فقد يرجع ذلك إلى وجود موارد Language متعددة في اشتراكك؛ وفي هذه الحالة:

    1. في الشريط الموجود أعلى الصفحة، حدّد زر **الإعدادات (&#9881؛**.
    2. في الصفحة **Settings** اعرض علامة التبويب **Resources**.
    3. حدد مورد language الذي أنشأته للتو، وانقر فوق **Switch resource**.
    4. في أعلى الصفحة، انقر فوق **Language Studio** للعودة إلى الصفحة الرئيسية في Language Studio

1. في أعلى المدخل، في القائمة **إنشاء جديد**، حدد **تصنيف النصوص المخصصة**.
1. تظهر صفحة **توصيل تخزين**. ستكون كافة القيم قد ملئت بالفعل. لذا حدد **التالي**.
1. في صفحة **تحديد نوع المشروع**، حدد **تصنيف ملصق مفرد**. بعد ذلك حدد **التالي**.
1. في جزء**إدخال المعلومات الأساسية**، ثم عيّن ما يلي:
    - **الاسم:** `ClassifyLab`  
    - **Text primary language**: English (US)
    - **الوصف**: `Custom text lab`

1. حدد **التالي**.
1. في صفحة **اختيار حاوية**، قم بتعيين القائمة المنسدلة**لحاوية متجر كائن ثنائي الحجم** على حاوية *مقالاتك*.
1. حدد الخيار ** لا، أحتاج إلى تسمية ملفاتي كجزء من هذا المشروع**. بعد ذلك حدد **التالي**.
1. حدد **إنشاء مشروع**

> **تلميح**: إذا ظهر لديك خطأ بشأن عدم تفويضك لتنفيذ هذه العملية، فستحتاج إلى إضافة تعيين دور. لتصحيح ذلك، نقوم بإضافة دور "المساهم ببيانات الكائن الثنائي كبير الحجم للتخزين" على حساب التخزين للمستخدم والذي يقوم بتشغيل النشاط العملي. يمكن العثور على مزيدٍ من التفاصيل في [صفحة الوثائق](https://learn.microsoft.com/azure/ai-services/language-service/custom-named-entity-recognition/how-to/create-project?tabs=portal%2Clanguage-studio#enable-identity-management-for-your-resource).

## تسمية البيانات

الآن بعد أن تم إنشاء مشروعك، تحتاج إلى تسمية بياناتك أو وضع علامة عليها لتدريب نموذجك على كيفية تصنيف النص.

1. على اليسار، حدد **تسمية البيانات**، إذا لم تكن محددة بالفعل. سترى قائمة بالملفات التي قمت بتحميلها إلى حساب التخزين الخاص بك.
1. على الجانب الأيسر، في جزء**النشاط**، حدد **+ إضافة فئة**.  تندرج المقالات في هذا المعمل في أربع فئات ستحتاج إلى إنشائها: `Classifieds`و `Sports` و`News`و `Entertainment`.

    ![لقطة شاشة تعرض صفحة «tag data» وزر «add class».](../media/tag-data-add-class-new.png#lightbox)

1. بعد إنشاء الفئات الأربع، حدد **مقالة 1** للبدء. هنا يمكنك قراءة المقالة، وتحديد الفئة التي يمثلها هذا الملف، ومجموعة البيانات (التدريب أو الاختبار) التي تريد تخصيصها.
1. قم بتعيين كل مقالة للفئة المناسبة ومجموعة البيانات (التدريب أو الاختبار) باستخدام جزء **النشاط** على اليمين.  يمكنك تحديد تسمية من قائمة التسميات على اليمين، وتعيين كل مقالة **للتدريب** أو **الاختبار** باستخدام الخيارات الموجودة أسفل جزء النشاط. يمكنك تحديد **المستند التالي**للانتقال إلى المستند التالي. لأغراض هذا المختبر، سنحدد ما الذي سيتم استخدامه لتدريب النموذج واختباره:

    | مقالة  | الفصل  | مجموعة البيانات  |
    |---------|---------|---------|
    | Article 1 | رياضات | التدريب |
    | Article 10 | الأخبار | التدريب |
    | Article 11 | الترفيه | الاختبار |
    | Article 12 | الأخبار | الاختبار |
    | Article 13 | رياضات | الاختبار |
    | Article 2 | رياضات | التدريب |
    | Article 3 | Classifieds | التدريب |
    | Article 4 | Classifieds | التدريب |
    | Article 5 | الترفيه | التدريب |
    | Article 6 | الترفيه | التدريب |
    | Article 7 | الأخبار | التدريب |
    | Article 8 | الأخبار | التدريب |
    | Article 9 | الترفيه | التدريب |

    > **ملاحظة**يتم سرد الملفات في Language Studio أبجديا، وهذا هو السبب في أن القائمة أعلاه ليست بترتيب تسلسلي. تأكد من زيارة صفحتي المستندات عند تسمية مقالاتك.

1. حدد **حفظ أوصاف** لحفظها.

## تدريب النموذج

بمجرد تسمية بياناتك، تحتاج إلى تدريب نموذجك.

1. حدد **وظائف تدريب** من القائمة الجانبية اليسرى.
1. حدد ** بدء وظيفة تدريب**.
1. تدريب نموذج جديد باسم `ClassifyArticles`.
1. حدد **استخدام تقسيم يدوي لبيانات التدريب والاختبار**.

    > **نصيحة** في مشاريع التصنيف الخاصة بك، ستقوم خدمة Azure AI Language تلقائيا بتقسيم الاختبار الذي تم تعيينه حسب النسبة المئوية وهو أمر مفيد مع مجموعة بيانات كبيرة. مع مجموعات البيانات الأصغر، من المهم التدريب مع توزيع الفئة المناسبة.

1. حدد **Train**

> **مهم** قد يستغرق تدريب نموذجك عدة دقائق في بعض الأحيان. ستتلقى إعلاما عند اكتماله.

## تقييم نموذجك

في تطبيقات العالم الحقيقي لتصنيف النص، من المهم تقييم نموذجك وتحسينه للتحقق من أدائه كما تتوقع.

1. حدد **Model performance**، وحدد نموذج **ClassifyArticles** خاصتك. ثم يمكنك أن ترى تسجيل النموذج الخاص بك، ومقاييس الأداء، ومتى تم تدريبه. إذا لم يكن تسجيل نموذجك 100%، فهذا يعني أن أحد المستندات المستخدمة للاختبار لم يتم تقييمه إلى ما تم تسميته. يمكن أن تساعدك هذه الإخفاقات على فهم مكان التحسين.
1. حدد علامة تبويب** تفاصيل مجموعة الاختبار**. إذا كانت هناك أي أخطاء، تُمكِّنك علامة التبويب هذه من الاطّلاع على المقالات التي حددتها للاختبار وما يتوقعه النموذج وما إذا كان ذلك يتعارض مع تسمية الاختبار الخاصة بها. تعين علامة التبويب افتراضيًا لإظهار تنبؤات غير صحيحة فقط. يمكنك تبديل **الخيار إظهار عدم التطابق فقط** لمشاهدة جميع المقالات التي أشرت إليها للاختبار وما توقعه كل منها.

## استخدام نموذجك

بمجرد أن تكون راضيًا عن تدريب النموذج الخاص بك، فقد حان الوقت لتوزيعه والذي يسمح لك بالبدء في تصنيف النص من خلال API.

1. في الجزء إلى اليسار، حدد **نشر نموذج**.
1. حدد **إضافة نشر**، ثم أدخل `articles` في **حقل قم بإنشاء اسم نشر جديد**، وحدد **تصنيف مقالات** في حقل **نموذج**.
1. حدد **نشر** لنشر نموذجك.
1. بمجرد نشر نموذجك اترك هذه الصفحة مفتوحة. ستكون بحاجة إلى اسم المشروع والنشر في الخطوة التالية.

## الإعداد لتطوير تطبيق في Cloud Shell

من أجل تجربة ميزات تصنيف النصوص المخصصة في خدمة Azure AI Language، ستنشئ تطبيقًا بسيطًا على وحدة تحكم باستخدام Azure Cloud Shell.

1. في بوابة Azure، استخدم الزر **[\>_]** على يمين شريط البحث أعلى الصفحة لإنشاء Cloud Shell جديد في بوابة Azure، وتحديد بيئة ***PowerShell***. يوفّر Cloud Shell واجهة سطر أوامر في جزء أسفل بوابة Azure.

    > **ملاحظة**: إذا كنت قد أنشأت مسبقًا Cloud Shell يستخدم بيئة *معالج Bash*، فبدّل إلى ***PowerShell***.

1. في شريط أدوات Cloud Shell، في قائمة **الإعدادات**، حدد **الانتقال إلى الإصدار الكلاسيكي** (هذا مطلوب لاستخدام محرر التعليمات البرمجية).

    **<font color="red">تأكد من التبديل إلى الإصدار الكلاسيكي من cloud shell قبل المتابعة.</font>**

1. في جزء PowerShell، أدخل الأوامر التالية لاستنساخ مستودع GitHub لهذا التمرين:

    ```
   rm -r mslearn-ai-language -f
   git clone https://github.com/microsoftlearning/mslearn-ai-language
    ```

    > **تلميح**: عند لصق الأوامر في CloudShell، قد يشغل الإخراج مساحة كبيرة من ذاكرة التخزين المؤقت للشاشة. يمكنك مسح الشاشة عن طريق إدخال الأمر `cls` لتسهيل التركيز على كل مهمة.

1. بعد استنساخ مخزن بيانات خاصة، انتقل إلى المجلد الذي يحتوي على ملفات التعليمات البرمجية لتطبيق الدردشة:  

    ```
   cd mslearn-ai-language/Labfiles/04-text-classification/Python/classify-text
    ```

## تكوين تطبيقك

1. في جزء سطر الأوامر، شغِّل الأمر التالي لعرض ملفات التعليمات البرمجية في المجلد **classify-text**:

    ```
   ls -a -l
    ```

    تتضمن الملفات ملف تكوين (**env.**) وملف تعليمات برمجية (**classify-text.py**). النص الذي سيحلله التطبيق الخاص بك موجود في المجلد الفرعي **المقالات**.

1. أنشئ بيئة افتراضية للغة Python وثبت حزمة تطوير البرامج (SDK) الخاصة بـ Azure AI Language Text Analytics وغيرها من الحزم المطلوبة عبر تنفيذ الأمر التالي:

    ```
   python -m venv labenv
   ./labenv/bin/Activate.ps1
   pip install -r requirements.txt azure-ai-textanalytics==5.3.0
    ```

1. أدخِل الأمر التالي لتحرير ملف تكوين التطبيق:

    ```
   code .env
    ```

    يتم فتح الملف في محرر التعليمات البرمجية.

1. حدِّث قيم التكوين لتتضمن **نقطة النهاية** و**مفتاح** من مورد Azure Language الذي أنشأته (متوفر في صفحة **المفاتيح ونقطة النهاية** لمورد Azure AI Language في مدخل Microsoft Azure). يجب أن يحتوي الملف بالفعل على أسماء المشروع والتوزيع لنموذج تصنيف النص الخاص بك.
1. بعد استبدال العناصر النائبة، استخدم الأمر **CTRL+S** أو **Right-click > Save** لحفظ التغييرات ثم استخدم الأمر **CTRL+Q** أو **Right-click > Quit** لإغلاق محرر التعليمات البرمجية مع إبقاء سطر أوامر Cloud Shell مفتوحًا.

## إضافة تعليمة برمجية لتصنيف المستندات

1. أدخِل الأمر التالي لفتح ملف التعليمات البرمجية الخاص بالتطبيق وتحريره:

    ```
    code classify-text.py
    ```

1. راجع التعليمات البرمجية الموجودة حاليًا. عليك إضافة التعليمات البرمجية لاستخدام عدة تطوير البرامج (SDK) الخاصة بـ AI Language Text Analytics.

    > **تلميح**: خلال إضافة التعليمات البرمجية إلى ملف التعليمات البرمجية، تأكد من الحفاظ على المسافة البادئة الصحيحة.

1. في بداية ملف التعليمات البرمجية، وضمن المراجع الحالية للمساحات الاسمية، ابحث عن التعليق **Import namespaces** وأضِف التعليمات البرمجية التالية لاستيراد المساحات الاسمية الضرورية لاستخدام عدة تطوير البرامج (SDK) الخاصة بـ Text Analytics:

    ```python
   # import namespaces
   from azure.core.credentials import AzureKeyCredential
   from azure.ai.textanalytics import TextAnalyticsClient
    ```

1. في الدالة **Main**، لاحظ أن التعليمات البرمجية الخاصة بتحميل نقطة النهاية وخاصية المفتاح لخدمة Azure AI Language وكذلك أسماء المشروع والتوزيع من ملف الإعدادات متوفر مسبقًا. ثم ابحث عن التعليق **Create client using endpoint and key**، وأضِف التعليمات البرمجية التالية لإنشاء عميل تحليلات النصوص:

    ```Python
   # Create client using endpoint and key
   credential = AzureKeyCredential(ai_key)
   ai_client = TextAnalyticsClient(endpoint=ai_endpoint, credential=credential)
    ```

1. لاحظ أن التعليمات البرمجية الموجودة تقرأ جميع الملفات في مجلد **المقالات** وتنشئ قائمة تتضمن محتوياتها. ثم ابحث عن التعليق **الحصول على تصنيفات** وأضف التعليمات البرمجية التالية:

     ```Python
   # Get Classifications
   operation = ai_client.begin_single_label_classify(
        batchedDocuments,
        project_name=project_name,
        deployment_name=deployment_name
   )

   document_results = operation.result()

   for doc, classification_result in zip(files, document_results):
        if classification_result.kind == "CustomDocumentClassification":
            classification = classification_result.classifications[0]
            print("{} was classified as '{}' with confidence score {}.".format(
                doc, classification.category, classification.confidence_score)
            )
        elif classification_result.is_error is True:
            print("{} has an error with code '{}' and message '{}'".format(
                doc, classification_result.error.code, classification_result.error.message)
            )
    ```

1. احفظ تغييراتك باستخدام (CTRL+S)، بعدها نفذ الأمر التالي لتشغيل البرنامج (قُم بتكبير جزء cloud shell وتعديل حجم الألواح لمشاهدة المزيد من النص في جزء سطر الأوامر):

    ```
   python classify-text.py
    ```

1. مراقبة المخرجات. يجب أن يسرد التطبيق تصنيفا ودرجة ثقة لكل ملف نصي.

## تنظيف

إذا لم تعُد تحتاج إلى مشروعك، فيمكنك حذفه من صفحة **المشروعات** الخاصة بك في Language Studio. يمكنك أيضا إزالة خدمة Azure AI Language وحساب التخزين المقترن في [مدخل Microsoft Azure](https://portal.azure.com).
